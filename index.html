<!doctype html>
<html lang="ru">
  <head>
    <meta charset="utf-8">
    <title>QuackJS</title>
    <script src="./quack.js"></script>
  </head>
  <body style="font-family:sans-serif; margin:40px;">
    <h1>üê• QuackJS ‚Äî Realtime notification</h1>
    <h1 id="youtoken"></h1>
    <button id="notify">Show local notification</button>
    <p>Send all a test notification from the server:</p>
    <pre><code>curl -X POST http://localhost:3000/notify -H "Content-Type: application/json" -d '{"title":"Hello!","body":"Its is server notification"}'</code></pre>
	
	<p>Send a message to a user with a token:</p>
    <pre><code>curl -X POST http://localhost:3000/notify -H "Content-Type: application/json" -d '{"token":"TOKEN_HERE","title":"Private!","body":"Only for this user"}'</code></pre>
	
    <script>
	const randToken = Math.floor(Math.random() * 100);
	document.getElementById("youtoken").innerHTML = 'Your token: ' + randToken;
     const q = new Quack({
		url: "ws://localhost:3000",
		transport: "auto",
		native: true,
		token: randToken
	 });

      q.on("connect", info => console.log("‚úÖ Connected:", info));
      q.on("notification", n => console.log("üì© Notification received:", n));

      q.requestPermission().then(s => console.log("Permission:", s));

      q.connect();

      document.getElementById("notify").onclick = () => {
        q.show({ title: "Local", body: "Test notification!" });
      };
    </script>
  </body>
</html>
